function [fA] = assembly_fft_circ_pwc_(A)

    [n1,n2,n3,n4] = size(A);    

    if n4 == 6
        G_n1   = [ +1 -1 -1 +1 +1 +1 ];
        G_n2   = [ +1 -1 +1 +1 -1 +1 ];
        G_n3   = [ +1 +1 -1 +1 -1 +1 ];
        G_n1n2  = [ +1 +1 -1 +1 -1 +1 ];
        G_n1n3  = [ +1 -1 +1 +1 -1 +1 ];
        G_n2n3  = [ +1 -1 -1 +1 +1 +1 ];
        G_n1n2n3 = [ +1 +1 +1 +1 +1 +1 ];
    elseif n4 == 3
        G_n1   = [ -1 +1 +1 ];
        G_n2   = [ +1 -1 +1 ];
        G_n3   = [ +1 +1 -1 ];
        G_n1n2  = [ -1 -1 +1 ];
        G_n1n3  = [ -1 +1 -1 ];
        G_n2n3  = [ +1 -1 -1 ];
        G_n1n2n3 = [ -1 -1 -1 ];
    end
    
    fA = zeros(2*n1,2*n2,2*n3,n4);
    fA(1:n1,1:n2,1:n3,:) = A;

    for i = 1:n4
        fA(n1+2:2*n1,1:n2        ,1:n3,i)           = A(n1:-1:2, 1:n2    , 1:n3,i)      * G_n1(i);
        fA(1:n1        ,n2+2:2*n2,1:n3,i)           = A(1:n1    , n2:-1:2, 1:n3,i)      * G_n2(i);
        fA(1:n1        ,1:n2         ,n3+2:2*n3,i)  = A(1:n1    , 1:n2    , n3:-1:2,i)  * G_n3(i);
        fA(n1+2:2*n1,n2+2:2*n2,1:n3,i)           = A(n1:-1:2, n2:-1:2, 1:n3,i)      * G_n1n2(i);
        fA(n1+2:2*n1,1:n2        ,n3+2:2*n3,i)   = A(n1:-1:2, 1:n2    , n3:-1:2,i)  * G_n1n3(i);
        fA(1:n1        ,n2+2:2*n2,n3+2:2*n3,i)   = A(1:n1    , n2:-1:2, n3:-1:2,i)  * G_n2n3(i);
        fA(n1+2:2*n1,n2+2:2*n2,n3+2:2*n3,i)   = A(n1:-1:2, n2:-1:2, n3:-1:2,i)  * G_n1n2n3(i);
    end

    for i = 1:n4
        fA(:,:,:,i) = fftn(fA(:,:,:,i));
    end

end
